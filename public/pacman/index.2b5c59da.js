/*!
 * Copyright 2018
 * Google LLC
 * PAC-MAN TM & Â©BANDAI NAMCO Entertainment Inc.
 */window.google={},google.dom={},google.pacManSound=!0,google.browser={},google.browser.engine={};var e="https://storage.googleapis.com/tfjs-examples/assets/webcam-transfer-learning/pacman-sprite.png";google.dom.remove=function(e){return e&&e.parentNode&&e.parentNode.removeChild(e)},google.dom.append=function(e){return document.body.appendChild(e)},google.pacman||function(){var t={},i=[1,4,2,8],o={0:{axis:0,increment:0},1:{axis:0,increment:-1},2:{axis:0,increment:1},4:{axis:1,increment:-1},8:{axis:1,increment:1}},a=[{x:5,y:1,w:56},{x:5,y:4,w:5},{x:5,y:1,h:4},{x:9,y:1,h:12},{x:5,y:12,h:4},{x:10,y:12,h:4},{x:5,y:15,w:16},{x:5,y:12,w:31},{x:60,y:1,h:4},{x:54,y:1,h:4},{x:19,y:1,h:12},{x:19,y:4,w:26},{x:13,y:5,w:7},{x:13,y:5,h:4},{x:13,y:8,w:3},{x:56,y:4,h:9},{x:48,y:4,w:13},{x:48,y:1,h:12},{x:60,y:12,h:4},{x:44,y:15,w:17},{x:54,y:12,h:4},{x:44,y:12,w:17},{x:44,y:1,h:15},{x:41,y:13,w:4},{x:41,y:13,h:3},{x:38,y:13,h:3},{x:38,y:15,w:4},{x:35,y:10,w:10},{x:35,y:1,h:15},{x:35,y:13,w:4},{x:21,y:12,h:4},{x:24,y:12,h:4},{x:24,y:15,w:12},{x:27,y:4,h:9},{x:52,y:9,w:5},{x:56,y:8,w:10,type:1},{x:1,y:8,w:9,type:1}],s=[{x:1,y:8,w:8},{x:57,y:8,w:9},{x:44,y:2,h:10},{x:35,y:5,h:7},{x:36,y:4,w:8},{x:36,y:10,w:8},{x:39,y:15,w:2}],r=[{x:5,y:15},{x:5,y:3},{x:15,y:8},{x:60,y:3},{x:60,y:15}],n=[{x:2,y:8},{x:63,y:8}],l={1:[{x:39.5,y:15,dir:4},{x:39.5,y:4,dir:4,scatterX:57,scatterY:-4},{x:39.5,y:7,dir:2,scatterX:0,scatterY:-4},{x:37.625,y:7,dir:1,scatterX:57,scatterY:20},{x:41.375,y:7,dir:1,scatterX:0,scatterY:20}],2:[{x:40.25,y:15,dir:8},{x:38.75,y:15,dir:4},{x:39.5,y:4,dir:4,scatterX:57,scatterY:-4},{x:39.5,y:7,dir:2,scatterX:0,scatterY:-4},{x:37.625,y:7,dir:1,scatterX:57,scatterY:20},{x:41.375,y:7,dir:1,scatterX:0,scatterY:20}]},d={0:.16,1:.23,2:1,3:1,4:2.23,5:.3,6:1.9,7:2.23,8:1.9,9:5,10:1.9,11:1.18,12:.3,13:.5,14:1.9,15:9,16:10,17:.26},c=[{},{ghostSpeed:.75,ghostTunnelSpeed:.4,playerSpeed:.8,dotEatingSpeed:.71,ghostFrightSpeed:.5,playerFrightSpeed:.9,dotEatingFrightSpeed:.79,elroyDotsLeftPart1:20,elroySpeedPart1:.8,elroyDotsLeftPart2:10,elroySpeedPart2:.85,frightTime:6,frightBlinkCount:5,fruit:1,fruitScore:100,ghostModeSwitchTimes:[7,20,7,20,5,20,5,1],penForceTime:4,penLeavingLimits:[0,0,30,60]},{ghostSpeed:.85,ghostTunnelSpeed:.45,playerSpeed:.9,dotEatingSpeed:.79,ghostFrightSpeed:.55,playerFrightSpeed:.95,dotEatingFrightSpeed:.83,elroyDotsLeftPart1:30,elroySpeedPart1:.9,elroyDotsLeftPart2:15,elroySpeedPart2:.95,frightTime:5,frightBlinkCount:5,fruit:2,fruitScore:300,ghostModeSwitchTimes:[7,20,7,20,5,1033,1/60,1],penForceTime:4,penLeavingLimits:[0,0,0,50],cutsceneId:1},{ghostSpeed:.85,ghostTunnelSpeed:.45,playerSpeed:.9,dotEatingSpeed:.79,ghostFrightSpeed:.55,playerFrightSpeed:.95,dotEatingFrightSpeed:.83,elroyDotsLeftPart1:40,elroySpeedPart1:.9,elroyDotsLeftPart2:20,elroySpeedPart2:.95,frightTime:4,frightBlinkCount:5,fruit:3,fruitScore:500,ghostModeSwitchTimes:[7,20,7,20,5,1033,1/60,1],penForceTime:4,penLeavingLimits:[0,0,0,0]},{ghostSpeed:.85,ghostTunnelSpeed:.45,playerSpeed:.9,dotEatingSpeed:.79,ghostFrightSpeed:.55,playerFrightSpeed:.95,dotEatingFrightSpeed:.83,elroyDotsLeftPart1:40,elroySpeedPart1:.9,elroyDotsLeftPart2:20,elroySpeedPart2:.95,frightTime:3,frightBlinkCount:5,fruit:3,fruitScore:500,ghostModeSwitchTimes:[7,20,7,20,5,1033,1/60,1],penForceTime:4,penLeavingLimits:[0,0,0,0]},{ghostSpeed:.95,ghostTunnelSpeed:.5,playerSpeed:1,dotEatingSpeed:.87,ghostFrightSpeed:.6,playerFrightSpeed:1,dotEatingFrightSpeed:.87,elroyDotsLeftPart1:40,elroySpeedPart1:1,elroyDotsLeftPart2:20,elroySpeedPart2:1.05,frightTime:2,frightBlinkCount:5,fruit:4,fruitScore:700,ghostModeSwitchTimes:[5,20,5,20,5,1037,1/60,1],penForceTime:3,penLeavingLimits:[0,0,0,0],cutsceneId:2},{ghostSpeed:.95,ghostTunnelSpeed:.5,playerSpeed:1,dotEatingSpeed:.87,ghostFrightSpeed:.6,playerFrightSpeed:1,dotEatingFrightSpeed:.87,elroyDotsLeftPart1:50,elroySpeedPart1:1,elroyDotsLeftPart2:25,elroySpeedPart2:1.05,frightTime:5,frightBlinkCount:5,fruit:4,fruitScore:700,ghostModeSwitchTimes:[5,20,5,20,5,1037,1/60,1],penForceTime:3,penLeavingLimits:[0,0,0,0]},{ghostSpeed:.95,ghostTunnelSpeed:.5,playerSpeed:1,dotEatingSpeed:.87,ghostFrightSpeed:.6,playerFrightSpeed:1,dotEatingFrightSpeed:.87,elroyDotsLeftPart1:50,elroySpeedPart1:1,elroyDotsLeftPart2:25,elroySpeedPart2:1.05,frightTime:2,frightBlinkCount:5,fruit:5,fruitScore:1e3,ghostModeSwitchTimes:[5,20,5,20,5,1037,1/60,1],penForceTime:3,penLeavingLimits:[0,0,0,0]},{ghostSpeed:.95,ghostTunnelSpeed:.5,playerSpeed:1,dotEatingSpeed:.87,ghostFrightSpeed:.6,playerFrightSpeed:1,dotEatingFrightSpeed:.87,elroyDotsLeftPart1:50,elroySpeedPart1:1,elroyDotsLeftPart2:25,elroySpeedPart2:1.05,frightTime:2,frightBlinkCount:5,fruit:5,fruitScore:1e3,ghostModeSwitchTimes:[5,20,5,20,5,1037,1/60,1],penForceTime:3,penLeavingLimits:[0,0,0,0]},{ghostSpeed:.95,ghostTunnelSpeed:.5,playerSpeed:1,dotEatingSpeed:.87,ghostFrightSpeed:.6,playerFrightSpeed:1,dotEatingFrightSpeed:.87,elroyDotsLeftPart1:60,elroySpeedPart1:1,elroyDotsLeftPart2:30,elroySpeedPart2:1.05,frightTime:1,frightBlinkCount:3,fruit:6,fruitScore:2e3,ghostModeSwitchTimes:[5,20,5,20,5,1037,1/60,1],penForceTime:3,penLeavingLimits:[0,0,0,0],cutsceneId:3},{ghostSpeed:.95,ghostTunnelSpeed:.5,playerSpeed:1,dotEatingSpeed:.87,ghostFrightSpeed:.6,playerFrightSpeed:1,dotEatingFrightSpeed:.87,elroyDotsLeftPart1:60,elroySpeedPart1:1,elroyDotsLeftPart2:30,elroySpeedPart2:1.05,frightTime:5,frightBlinkCount:5,fruit:6,fruitScore:2e3,ghostModeSwitchTimes:[5,20,5,20,5,1037,1/60,1],penForceTime:3,penLeavingLimits:[0,0,0,0]},{ghostSpeed:.95,ghostTunnelSpeed:.5,playerSpeed:1,dotEatingSpeed:.87,ghostFrightSpeed:.6,playerFrightSpeed:1,dotEatingFrightSpeed:.87,elroyDotsLeftPart1:60,elroySpeedPart1:1,elroyDotsLeftPart2:30,elroySpeedPart2:1.05,frightTime:2,frightBlinkCount:5,fruit:7,fruitScore:3e3,ghostModeSwitchTimes:[5,20,5,20,5,1037,1/60,1],penForceTime:3,penLeavingLimits:[0,0,0,0]},{ghostSpeed:.95,ghostTunnelSpeed:.5,playerSpeed:1,dotEatingSpeed:.87,ghostFrightSpeed:.6,playerFrightSpeed:1,dotEatingFrightSpeed:.87,elroyDotsLeftPart1:80,elroySpeedPart1:1,elroyDotsLeftPart2:40,elroySpeedPart2:1.05,frightTime:1,frightBlinkCount:3,fruit:7,fruitScore:3e3,ghostModeSwitchTimes:[5,20,5,20,5,1037,1/60,1],penForceTime:3,penLeavingLimits:[0,0,0,0]},{ghostSpeed:.95,ghostTunnelSpeed:.5,playerSpeed:1,dotEatingSpeed:.87,ghostFrightSpeed:.6,playerFrightSpeed:1,dotEatingFrightSpeed:.87,elroyDotsLeftPart1:80,elroySpeedPart1:1,elroyDotsLeftPart2:40,elroySpeedPart2:1.05,frightTime:1,frightBlinkCount:3,fruit:8,fruitScore:5e3,ghostModeSwitchTimes:[5,20,5,20,5,1037,1/60,1],penForceTime:3,penLeavingLimits:[0,0,0,0],cutsceneId:3},{ghostSpeed:.95,ghostTunnelSpeed:.5,playerSpeed:1,dotEatingSpeed:.87,ghostFrightSpeed:.6,playerFrightSpeed:1,dotEatingFrightSpeed:.87,elroyDotsLeftPart1:80,elroySpeedPart1:1,elroyDotsLeftPart2:40,elroySpeedPart2:1.05,frightTime:3,frightBlinkCount:5,fruit:8,fruitScore:5e3,ghostModeSwitchTimes:[5,20,5,20,5,1037,1/60,1],penForceTime:3,penLeavingLimits:[0,0,0,0]},{ghostSpeed:.95,ghostTunnelSpeed:.5,playerSpeed:1,dotEatingSpeed:.87,ghostFrightSpeed:.6,playerFrightSpeed:1,dotEatingFrightSpeed:.87,elroyDotsLeftPart1:100,elroySpeedPart1:1,elroyDotsLeftPart2:50,elroySpeedPart2:1.05,frightTime:1,frightBlinkCount:3,fruit:8,fruitScore:5e3,ghostModeSwitchTimes:[5,20,5,20,5,1037,1/60,1],penForceTime:3,penLeavingLimits:[0,0,0,0]},{ghostSpeed:.95,ghostTunnelSpeed:.5,playerSpeed:1,dotEatingSpeed:.87,ghostFrightSpeed:.6,playerFrightSpeed:1,dotEatingFrightSpeed:.87,elroyDotsLeftPart1:100,elroySpeedPart1:1,elroyDotsLeftPart2:50,elroySpeedPart2:1.05,frightTime:1,frightBlinkCount:3,fruit:8,fruitScore:5e3,ghostModeSwitchTimes:[5,20,5,20,5,1037,1/60,1],penForceTime:3,penLeavingLimits:[0,0,0,0]},{ghostSpeed:.95,ghostTunnelSpeed:.5,playerSpeed:1,dotEatingSpeed:.87,ghostFrightSpeed:.6,playerFrightSpeed:1,dotEatingFrightSpeed:.87,elroyDotsLeftPart1:100,elroySpeedPart1:1,elroyDotsLeftPart2:50,elroySpeedPart2:1.05,frightTime:0,frightBlinkCount:0,fruit:8,fruitScore:5e3,ghostModeSwitchTimes:[5,20,5,20,5,1037,1/60,1],penForceTime:3,penLeavingLimits:[0,0,0,0],cutsceneId:3},{ghostSpeed:.95,ghostTunnelSpeed:.5,playerSpeed:1,dotEatingSpeed:.87,ghostFrightSpeed:.6,playerFrightSpeed:1,dotEatingFrightSpeed:.87,elroyDotsLeftPart1:100,elroySpeedPart1:1,elroyDotsLeftPart2:50,elroySpeedPart2:1.05,frightTime:1,frightBlinkCount:3,fruit:8,fruitScore:5e3,ghostModeSwitchTimes:[5,20,5,20,5,1037,1/60,1],penForceTime:3,penLeavingLimits:[0,0,0,0]},{ghostSpeed:.95,ghostTunnelSpeed:.5,playerSpeed:1,dotEatingSpeed:.87,ghostFrightSpeed:.6,playerFrightSpeed:1,dotEatingFrightSpeed:.87,elroyDotsLeftPart1:120,elroySpeedPart1:1,elroyDotsLeftPart2:60,elroySpeedPart2:1.05,frightTime:0,frightBlinkCount:0,fruit:8,fruitScore:5e3,ghostModeSwitchTimes:[5,20,5,20,5,1037,1/60,1],penForceTime:3,penLeavingLimits:[0,0,0,0]},{ghostSpeed:.95,ghostTunnelSpeed:.5,playerSpeed:1,dotEatingSpeed:.87,ghostFrightSpeed:.6,playerFrightSpeed:1,dotEatingFrightSpeed:.87,elroyDotsLeftPart1:120,elroySpeedPart1:1,elroyDotsLeftPart2:60,elroySpeedPart2:1.05,frightTime:0,frightBlinkCount:0,fruit:8,fruitScore:5e3,ghostModeSwitchTimes:[5,20,5,20,5,1037,1/60,1],penForceTime:3,penLeavingLimits:[0,0,0,0]},{ghostSpeed:.95,ghostTunnelSpeed:.5,playerSpeed:.9,dotEatingSpeed:.79,ghostFrightSpeed:.75,playerFrightSpeed:.9,dotEatingFrightSpeed:.79,elroyDotsLeftPart1:120,elroySpeedPart1:1,elroyDotsLeftPart2:60,elroySpeedPart2:1.05,frightTime:0,frightBlinkCount:0,fruit:8,fruitScore:5e3,ghostModeSwitchTimes:[5,20,5,20,5,1037,1/60,1],penForceTime:3,penLeavingLimits:[0,0,0,0]}],p={1:[{x:37.6,y:7,dir:1,dest:6.375,speed:.48},{x:37.6,y:6.375,dir:2,dest:7.625,speed:.48},{x:37.6,y:7.625,dir:1,dest:7,speed:.48}],2:[{x:39.5,y:7,dir:2,dest:7.625,speed:.48},{x:39.5,y:7.625,dir:1,dest:6.375,speed:.48},{x:39.5,y:6.375,dir:2,dest:7,speed:.48}],3:[{x:41.4,y:7,dir:1,dest:6.375,speed:.48},{x:41.4,y:6.375,dir:2,dest:7.625,speed:.48},{x:41.4,y:7.625,dir:1,dest:7,speed:.48}],4:[{x:37.6,y:7,dir:8,dest:39.5,speed:.8*.4},{x:39.5,y:7,dir:1,dest:4,speed:.8*.4}],5:[{x:39.5,y:7,dir:1,dest:4,speed:.8*.4}],6:[{x:41.4,y:7,dir:4,dest:39.5,speed:.8*.4},{x:39.5,y:7,dir:1,dest:4,speed:.8*.4}],7:[{x:39.5,y:4,dir:2,dest:7,speed:1.6},{x:39.5,y:7,dir:4,dest:37.625,speed:1.6}],8:[{x:39.5,y:4,dir:2,dest:7,speed:1.6}],9:[{x:39.5,y:4,dir:2,dest:7,speed:1.6},{x:39.5,y:7,dir:8,dest:41.375,speed:1.6}],10:[{x:37.6,y:7,dir:8,dest:39.5,speed:.8*.4},{x:39.5,y:7,dir:1,dest:4,speed:.8*.4}],11:[{x:39.5,y:7,dir:1,dest:4,speed:.8*.4}],12:[{x:41.4,y:7,dir:4,dest:39.5,speed:.8*.4},{x:39.5,y:7,dir:1,dest:4,speed:.8*.4}]},h={1:{actors:[{ghost:!1,x:64,y:9,id:0},{ghost:!0,x:68.2,y:9,id:1}],sequence:[{time:5.5,moves:[{dir:4,speed:.75*1.6},{dir:4,speed:.78*1.6}]},{time:.1,moves:[{dir:4,speed:32},{dir:4,speed:0}]},{time:9,moves:[{dir:8,speed:.75*1.6,elId:"pcm-bpcm"},{dir:8,speed:.8,mode:4}]}]},2:{actors:[{ghost:!1,x:64,y:9,id:0},{ghost:!0,x:70.2,y:9,id:1},{ghost:!0,x:32,y:9.5,id:2}],sequence:[{time:2.7,moves:[{dir:4,speed:.75*1.6},{dir:4,speed:.78*1.6},{dir:0,speed:0,elId:"pcm-stck"}]},{time:1,moves:[{dir:4,speed:.75*1.6},{dir:4,speed:.1*.8},{dir:0,speed:0,elId:"pcm-stck"}]},{time:1.3,moves:[{dir:4,speed:.75*1.6},{dir:4,speed:0},{dir:0,speed:0,elId:"pcm-stck"}]},{time:1,moves:[{dir:4,speed:.75*1.6},{dir:4,speed:0,elId:"pcm-ghfa"},{dir:0,speed:0,elId:"pcm-stck"}]},{time:2.5,moves:[{dir:4,speed:.75*1.6},{dir:4,speed:0,elId:"pcm-ghfa"},{dir:0,speed:0,elId:"pcm-stck"}]}]},3:{actors:[{ghost:!1,x:64,y:9,id:0},{ghost:!0,x:70.2,y:9,id:2}],sequence:[{time:5.3,moves:[{dir:4,speed:.75*1.6},{dir:4,speed:.78*1.6,elId:"pcm-ghin"}]},{time:5.3,moves:[{dir:4,speed:0},{dir:8,speed:.78*1.6,elId:"pcm-gbug"}]}]}},g=[90,60,45],u=g[0];function m(e){this.id=e}m.prototype.A=function(){var e=l[t.playerCount][this.id];this.pos=[8*e.y,8*e.x],this.posDelta=[0,0],this.tilePos=[8*e.y,8*e.x],this.targetPos=[8*e.scatterY,8*e.scatterX],this.scatterPos=[8*e.scatterY,8*e.scatterX],this.lastActiveDir=this.dir=e.dir,this.physicalSpeed=this.requestedDir=this.nextDir=0,this.c(0),this.reverseDirectionsNext=this.freeToLeavePen=this.modeChangedWhileInPen=this.eatenInThisFrightMode=!1,this.l()},m.prototype.createElement=function(){this.el=document.createElement("div"),this.el.className="pcm-ac",this.el.id="actor"+this.id,t.prepareElement(this.el,0,0),t.playfieldEl.appendChild(this.el),this.elPos=[0,0],this.elBackgroundPos=[0,0]},m.prototype.a=function(e){var i=this.mode;switch(this.mode=e,this.id==t.playerCount+3&&(16==e||16==i)&&t.updateCruiseElroySpeed(),i){case 32:t.ghostExitingPenNow=!1;break;case 8:t.ghostEyesCount>0&&t.ghostEyesCount--,0==t.ghostEyesCount&&t.playAmbientSound()}switch(e){case 4:this.fullSpeed=.8*t.levels.ghostFrightSpeed,this.tunnelSpeed=.8*t.levels.ghostTunnelSpeed,this.followingRoutine=!1;break;case 1:this.fullSpeed=.8*t.levels.ghostSpeed,this.tunnelSpeed=.8*t.levels.ghostTunnelSpeed,this.followingRoutine=!1;break;case 2:this.targetPos=this.scatterPos,this.fullSpeed=.8*t.levels.ghostSpeed,this.tunnelSpeed=.8*t.levels.ghostTunnelSpeed,this.followingRoutine=!1;break;case 8:this.tunnelSpeed=this.fullSpeed=1.6,this.targetPos=[32,312],this.freeToLeavePen=this.followingRoutine=!1;break;case 16:switch(this.l(),this.followingRoutine=!0,this.routineMoveId=-1,this.id){case t.playerCount+1:this.routineToFollow=2;break;case t.playerCount+2:this.routineToFollow=1;break;case t.playerCount+3:this.routineToFollow=3}break;case 32:switch(this.followingRoutine=!0,this.routineMoveId=-1,this.id){case t.playerCount+1:this.routineToFollow=5;break;case t.playerCount+2:this.routineToFollow=4;break;case t.playerCount+3:this.routineToFollow=6}t.ghostExitingPenNow=!0;break;case 64:switch(this.followingRoutine=!0,this.routineMoveId=-1,this.id){case t.playerCount:case t.playerCount+1:this.routineToFollow=8;break;case t.playerCount+2:this.routineToFollow=7;break;case t.playerCount+3:this.routineToFollow=9}break;case 128:switch(this.followingRoutine=!0,this.routineMoveId=-1,this.id){case t.playerCount:case t.playerCount+1:this.routineToFollow=11;break;case t.playerCount+2:this.routineToFollow=10;break;case t.playerCount+3:this.routineToFollow=12}}this.d()},m.prototype.l=function(){this.id>=t.playerCount&&(this.targetPlayerId=Math.floor(t.rand()*t.playerCount))},m.prototype.z=function(e){if(t.userDisabledSound||(google.pacManSound=!0,t.updateSoundIcon()),this.dir==t.oppositeDirections[e])this.dir=e,this.posDelta=[0,0],2!=this.currentSpeed&&this.c(0),0!=this.dir&&(this.lastActiveDir=this.dir),this.nextDir=0;else if(this.dir!=e){if(0==this.dir)t.playfield[this.pos[0]][this.pos[1]].allowedDir&e&&(this.dir=e);else{var i=t.playfield[this.tilePos[0]][this.tilePos[1]];if(i&&i.allowedDir&e){i=o[this.dir];var a=[this.pos[0],this.pos[1]];a[i.axis]-=i.increment;var s=0;if(a[0]==this.tilePos[0]&&a[1]==this.tilePos[1]?s=1:(a[i.axis]-=i.increment,a[0]==this.tilePos[0]&&a[1]==this.tilePos[1]&&(s=2)),s){this.dir=e,this.pos[0]=this.tilePos[0],this.pos[1]=this.tilePos[1],i=o[this.dir],this.pos[i.axis]+=i.increment*s;return}}this.nextDir=e,this.posDelta=[0,0]}}},m.prototype.i=function(e){var a=this.tilePos,s=o[this.dir],r=[a[0],a[1]];r[s.axis]+=8*s.increment;var n=t.playfield[r[0]][r[1]];if(e&&!n.intersection&&(n=t.playfield[a[0]][a[1]]),n.intersection)switch(this.mode){case 2:case 1:case 8:if((this.dir&n.allowedDir)==0&&n.allowedDir==t.oppositeDirections[this.dir])this.nextDir=t.oppositeDirections[this.dir];else{for(var l in e=99999999999,a=0,i){var d=i[l];if(n.allowedDir&d&&this.dir!=t.oppositeDirections[d]){s=o[d];var c=[r[0],r[1]];c[s.axis]+=s.increment,(s=t.getDistance(c,[this.targetPos[0],this.targetPos[1]]))<e&&(e=s,a=d)}}a&&(this.nextDir=a)}break;case 4:if((this.dir&n.allowedDir)==0&&n.allowedDir==t.oppositeDirections[this.dir])this.nextDir=t.oppositeDirections[this.dir];else{do r=i[Math.floor(4*t.rand())];while((r&n.allowedDir)==0||r==t.oppositeDirections[this.dir])this.nextDir=r}}},m.prototype.p=function(e){t.tilesChanged=!0,this.reverseDirectionsNext&&(this.dir=t.oppositeDirections[this.dir],this.nextDir=0,this.reverseDirectionsNext=!1,this.i(!0)),this.ghost||t.playfield[e[0]][e[1]].path?this.lastGoodTilePos=[e[0],e[1]]:(this.pos[0]=this.lastGoodTilePos[0],this.pos[1]=this.lastGoodTilePos[1],e[0]=this.lastGoodTilePos[0],e[1]=this.lastGoodTilePos[1],this.dir=0),1==t.playfield[e[0]][e[1]].type&&8!=this.mode?this.c(2):this.c(0),!this.ghost&&t.playfield[e[0]][e[1]].dot&&t.dotEaten(this.id,e),this.tilePos[0]=e[0],this.tilePos[1]=e[1]},m.prototype.t=function(){var e=this.tilePos;switch(this.dir){case 1:var t=[e[0],e[1]],i=[e[0]+3.6,e[1]];break;case 2:t=[e[0]-4,e[1]],i=[e[0],e[1]];break;case 4:t=[e[0],e[1]],i=[e[0],e[1]+3.6];break;case 8:t=[e[0],e[1]-4],i=[e[0],e[1]]}this.pos[0]>=t[0]&&this.pos[0]<=i[0]&&this.pos[1]>=t[1]&&this.pos[1]<=i[1]&&(e=o[this.nextDir],this.posDelta[e.axis]+=e.increment)},m.prototype.n=function(){this.pos[0]==8*n[0].y&&this.pos[1]==8*n[0].x?(this.pos[0]=8*n[1].y,this.pos[1]=(n[1].x-1)*8):this.pos[0]==8*n[1].y&&this.pos[1]==8*n[1].x&&(this.pos[0]=8*n[0].y,this.pos[1]=(n[0].x+1)*8),8==this.mode&&32==this.pos[0]&&312==this.pos[1]&&this.a(64),this.ghost||80!=this.pos[0]||312!=this.pos[1]&&320!=this.pos[1]||t.eatFruit(this.id)},m.prototype.u=function(){this.n(),this.ghost&&this.i(!1);var e=t.playfield[this.pos[0]][this.pos[1]];e.intersection&&(this.nextDir&&this.nextDir&e.allowedDir?(0!=this.dir&&(this.lastActiveDir=this.dir),this.dir=this.nextDir,this.nextDir=0,this.ghost||(this.pos[0]+=this.posDelta[0],this.pos[1]+=this.posDelta[1],this.posDelta=[0,0])):(this.dir&e.allowedDir)==0&&(0!=this.dir&&(this.lastActiveDir=this.dir),this.nextDir=this.dir=0,this.c(0)))},m.prototype.o=function(){var e=this.pos[0]/8,i=this.pos[1]/8,o=[8*Math.round(e),8*Math.round(i)];o[0]!=this.tilePos[0]||o[1]!=this.tilePos[1]?this.p(o):(e=[8*Math.floor(e),8*Math.floor(i)],this.pos[1]==e[1]&&this.pos[0]==e[0]&&this.u()),!this.ghost&&this.nextDir&&t.playfield[o[0]][o[1]].intersection&&this.nextDir&t.playfield[o[0]][o[1]].allowedDir&&this.t()},m.prototype.B=function(){if(this.id==t.playerCount&&t.dotsRemaining<t.levels.elroyDotsLeftPart1&&2==this.mode&&(!t.lostLifeOnThisLevel||16!=t.actors[t.playerCount+3].mode)){var e=t.actors[this.targetPlayerId];this.targetPos=[e.tilePos[0],e.tilePos[1]]}else if(this.ghost&&1==this.mode)switch(e=t.actors[this.targetPlayerId],this.id){case t.playerCount:this.targetPos=[e.tilePos[0],e.tilePos[1]];break;case t.playerCount+1:this.targetPos=[e.tilePos[0],e.tilePos[1]];var i=o[e.dir];this.targetPos[i.axis]+=32*i.increment,1==e.dir&&(this.targetPos[1]-=32);break;case t.playerCount+2:var a=t.actors[t.playerCount],s=[e.tilePos[0],e.tilePos[1]];i=o[e.dir],s[i.axis]+=16*i.increment,1==e.dir&&(s[1]-=16),this.targetPos[0]=2*s[0]-a.tilePos[0],this.targetPos[1]=2*s[1]-a.tilePos[1];break;case t.playerCount+3:i=t.getDistance(e.tilePos,this.tilePos),this.targetPos=i>64?[e.tilePos[0],e.tilePos[1]]:this.scatterPos}},m.prototype.v=function(){if(this.routineMoveId++,this.routineMoveId==p[this.routineToFollow].length){if(16==this.mode&&this.freeToLeavePen&&!t.ghostExitingPenNow){this.eatenInThisFrightMode?this.a(128):this.a(32);return}if(32==this.mode||128==this.mode){this.pos=[32,316],this.dir=this.modeChangedWhileInPen?8:4;var e=t.mainGhostMode;128==this.mode&&4==e&&(e=t.lastMainGhostMode),this.a(e);return}if(64==this.mode){this.id==t.playerCount||this.freeToLeavePen?this.a(128):(this.eatenInThisFrightMode=!0,this.a(16));return}this.routineMoveId=0}e=p[this.routineToFollow][this.routineMoveId],this.pos[0]=8*e.y,this.pos[1]=8*e.x,this.dir=e.dir,this.physicalSpeed=0,this.speedIntervals=t.getSpeedIntervals(e.speed),this.proceedToNextRoutineMove=!1,this.b()},m.prototype.m=function(){var e=p[this.routineToFollow][this.routineMoveId];if(e&&this.speedIntervals[t.intervalTime]){var i=o[this.dir];switch(this.pos[i.axis]+=i.increment,this.dir){case 1:case 4:this.pos[i.axis]<8*e.dest&&(this.pos[i.axis]=8*e.dest,this.proceedToNextRoutineMove=!0);break;case 2:case 8:this.pos[i.axis]>8*e.dest&&(this.pos[i.axis]=8*e.dest,this.proceedToNextRoutineMove=!0)}this.b()}},m.prototype.j=function(){(-1==this.routineMoveId||this.proceedToNextRoutineMove)&&this.v(),this.m()},m.prototype.d=function(){switch(this.currentSpeed){case 0:var e=this.id==t.playerCount&&(2==this.mode||1==this.mode)?t.cruiseElroySpeed:this.fullSpeed;break;case 1:e=this.dotEatingSpeed;break;case 2:e=this.tunnelSpeed}this.physicalSpeed!=e&&(this.physicalSpeed=e,this.speedIntervals=t.getSpeedIntervals(this.physicalSpeed))},m.prototype.c=function(e){this.currentSpeed=e,this.d()},m.prototype.e=function(){if(this.dir&&this.speedIntervals[t.intervalTime]){var e=o[this.dir];this.pos[e.axis]+=e.increment,this.o(),this.b()}},m.prototype.move=function(){(0==t.gameplayMode||this.ghost&&1==t.gameplayMode&&(8==this.mode||64==this.mode))&&(0!=this.requestedDir&&(this.z(this.requestedDir),this.requestedDir=0),this.followingRoutine?(this.j(),64==this.mode&&this.j()):(this.e(),8==this.mode&&this.e()))},m.prototype.k=function(){var e=t.getPlayfieldX(this.pos[1]+this.posDelta[1]),i=t.getPlayfieldY(this.pos[0]+this.posDelta[0]);(this.elPos[0]!=i||this.elPos[1]!=e)&&(this.elPos[0]=i,this.elPos[1]=e,this.el.style.left=e+"px",this.el.style.top=i+"px")},m.prototype.s=function(){var e=0,i=0,o=this.dir;if(0==o&&(o=this.lastActiveDir),1==t.gameplayMode&&this.id==t.playerEatingGhostId)e=3,i=0;else if((9==t.gameplayMode||10==t.gameplayMode)&&0==this.id)e=2,i=0;else if(4==t.gameplayMode||5==t.gameplayMode||7==t.gameplayMode)e=0==this.id?2:4,i=0;else if(3==t.gameplayMode){if(this.id==t.playerDyingId){if(o=20-Math.floor(t.gameplayModeTime/t.timing[4]*21),0==this.id){switch(e=o-1){case -1:e=0;break;case 11:e=10;break;case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:e=11}i=12}else switch(o){case 0:case 1:case 2:case 6:case 10:e=4,i=3;break;case 3:case 7:case 11:e=4,i=0;break;case 4:case 8:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:e=4,i=2;break;case 5:case 9:e=4,i=1}}else e=3,i=0}else if("pcm-bpcm"==this.el.id)e=14,i=0,3==(o=Math.floor(.2*t.globalTime)%4)&&(o=1),i+=2*o;else{switch(o){case 4:i=0;break;case 8:i=1;break;case 1:i=2;break;case 2:i=3}2!=t.gameplayMode&&(e=Math.floor(.3*t.globalTime)%4),3==e&&0==this.dir&&(e=0),2==e&&0==this.id&&(e=0),3==e&&(e=2,0==this.id&&(i=0)),1==this.id&&(e+=4)}return[i,e]},m.prototype.r=function(){var e=0,i=0;if(10==t.gameplayMode||4==t.gameplayMode||3==t.gameplayMode)e=3,i=0;else if(1==t.gameplayMode&&this.id==t.ghostBeingEatenId){switch(t.modeScoreMultiplier){case 2:e=0;break;case 4:e=1;break;case 8:e=2;break;case 16:e=3}i=11,this.el.className="pcm-ac pcm-n"}else if(4!=this.mode&&(16!=this.mode&&32!=this.mode||4!=t.mainGhostMode||this.eatenInThisFrightMode)){if(8==this.mode||64==this.mode){switch((i=this.nextDir)||(i=this.dir),i){case 4:e=2;break;case 8:e=3;break;case 1:e=0;break;case 2:e=1}i=10}else if("pcm-ghin"==this.el.id)i=8,e=6+Math.floor(t.globalTime/16)%2;else if("pcm-gbug"==this.el.id)e=6,i=9+Math.floor(t.globalTime/16)%2;else if("pcm-ghfa"==this.el.id)e=3==t.cutsceneSequenceId?6:7,i=11;else if("pcm-stck"==this.el.id)e=1==t.cutsceneSequenceId?t.cutsceneTime>60?1:t.cutsceneTime>45?2:3:2==t.cutsceneSequenceId?3:3==t.cutsceneSequenceId||4==t.cutsceneSequenceId?4:0,i=13;else{switch((i=this.nextDir)&&1!=t.playfield[this.tilePos[0]][this.tilePos[1]].type||(i=this.dir),i){case 4:e=4;break;case 8:e=6;break;case 1:e=0;break;case 2:e=2}i=4+this.id-t.playerCount,(this.speed>0||13!=t.gameplayMode)&&(e+=Math.floor(t.globalTime/16)%2)}}else e=0,i=8,t.frightModeTime<t.levels.frightTotalTime-t.levels.frightTime&&Math.floor(t.frightModeTime/t.timing[1])%2==0&&(e+=2),e+=Math.floor(t.globalTime/16)%2;return[i,e]},m.prototype.b=function(){this.k();var e=[0,0];e=8==t.gameplayMode||14==t.gameplayMode?[0,3]:this.ghost?this.r():this.s(),(this.elBackgroundPos[0]!=e[0]||this.elBackgroundPos[1]!=e[1])&&(this.elBackgroundPos[0]=e[0],this.elBackgroundPos[1]=e[1],e[0]*=16,e[1]*=16,t.changeElementBkPos(this.el,e[1],e[0],!0))},t.rand=function(){var e=134775813;return e=134775813*t.randSeed+1,(t.randSeed=e%4294967296)/4294967296},t.seed=function(e){t.randSeed=e},t.getDistance=function(e,t){return Math.sqrt((t[1]-e[1])*(t[1]-e[1])+(t[0]-e[0])*(t[0]-e[0]))},t.getPlayfieldX=function(e){return e+-32},t.getPlayfieldY=function(e){return e+0},t.getCorrectedSpritePos=function(e){return e/8*10+2},t.getDotElementId=function(e,t){return"pcm-d"+e+"-"+t},t.showElementById=function(e,t){var i=document.getElementById(e);i&&(i.style.visibility=t?"visible":"hidden")},t.getAbsoluteElPos=function(e){var t=[0,0];do t[0]+=e.offsetTop,t[1]+=e.offsetLeft;while(e=e.offsetParent)return t},t.prepareElement=function(i,o,a){o=t.getCorrectedSpritePos(parseInt(o,10)),a=t.getCorrectedSpritePos(parseInt(a,10)),t.useCss?(i.style.backgroundImage="url("+e+")",i.style.backgroundPosition=-o+"px "+-a+"px",i.style.backgroundRepeat="no-repeat"):(i.style.overflow="hidden",o="display: block; position: relative; left: "+-o+"px; top: "+-a+"px",i.innerHTML='<img style="'+o+'" src="'+e+'">')},t.changeElementBkPos=function(e,i,o,a){a&&(i=t.getCorrectedSpritePos(i),o=t.getCorrectedSpritePos(o)),t.useCss?e.style.backgroundPosition=-i+"px "+-o+"px":e.childNodes[0]&&(e.childNodes[0].style.left=-i+"px",e.childNodes[0].style.top=-o+"px")},t.determinePlayfieldDimensions=function(){for(var e in t.playfieldWidth=0,t.playfieldHeight=0,a){var i=a[e];i.w?(i=i.x+i.w-1)>t.playfieldWidth&&(t.playfieldWidth=i):(i=i.y+i.h-1)>t.playfieldHeight&&(t.playfieldHeight=i)}},t.preparePlayfield=function(){t.playfield=[];for(var e=0;e<=t.playfieldHeight+1;e++){t.playfield[8*e]=[];for(var i=-2;i<=t.playfieldWidth+1;i++)t.playfield[8*e][8*i]={path:0,dot:0,intersection:0}}},t.preparePaths=function(){for(var e in a){var i=a[e],o=i.type;if(i.w){for(var r=8*i.y,n=8*i.x;n<=(i.x+i.w-1)*8;n+=8)t.playfield[r][n].path=!0,0==t.playfield[r][n].dot&&(t.playfield[r][n].dot=1,t.dotsRemaining++),t.playfield[r][n].type=o&&(n==8*i.x||n==(i.x+i.w-1)*8)?0:o;t.playfield[r][8*i.x].intersection=!0,t.playfield[r][(i.x+i.w-1)*8].intersection=!0}else{for(n=8*i.x,r=8*i.y;r<=(i.y+i.h-1)*8;r+=8)t.playfield[r][n].path&&(t.playfield[r][n].intersection=!0),t.playfield[r][n].path=!0,0==t.playfield[r][n].dot&&(t.playfield[r][n].dot=1,t.dotsRemaining++),t.playfield[r][n].type=o&&(r==8*i.y||r==(i.y+i.h-1)*8)?0:o;t.playfield[8*i.y][n].intersection=!0,t.playfield[(i.y+i.h-1)*8][n].intersection=!0}}for(e in s)if(s[e].w)for(n=8*s[e].x;n<=(s[e].x+s[e].w-1)*8;n+=8)t.playfield[8*s[e].y][n].dot=0,t.dotsRemaining--;else for(r=8*s[e].y;r<=(s[e].y+s[e].h-1)*8;r+=8)t.playfield[r][8*s[e].x].dot=0,t.dotsRemaining--},t.prepareAllowedDirections=function(){for(var e=8;e<=8*t.playfieldHeight;e+=8)for(var i=8;i<=8*t.playfieldWidth;i+=8)t.playfield[e][i].allowedDir=0,t.playfield[e-8][i].path&&(t.playfield[e][i].allowedDir+=1),t.playfield[e+8][i].path&&(t.playfield[e][i].allowedDir+=2),t.playfield[e][i-8].path&&(t.playfield[e][i].allowedDir+=4),t.playfield[e][i+8].path&&(t.playfield[e][i].allowedDir+=8)},t.createDotElements=function(){for(var e=8;e<=8*t.playfieldHeight;e+=8)for(var i=8;i<=8*t.playfieldWidth;i+=8)if(t.playfield[e][i].dot){var o=document.createElement("div");o.className="pcm-d",o.id=t.getDotElementId(e,i),o.style.left=i+-32+"px",o.style.top=e+0+"px",t.playfieldEl.appendChild(o)}},t.createEnergizerElements=function(){for(var e in r){var i=r[e],o=t.getDotElementId(8*i.y,8*i.x);document.getElementById(o).className="pcm-e",t.prepareElement(document.getElementById(o),0,144),t.playfield[8*i.y][8*i.x].dot=2}},t.createFruitElement=function(){t.fruitEl=document.createElement("div"),t.fruitEl.id="pcm-f",t.fruitEl.style.left=t.getPlayfieldX(312)+"px",t.fruitEl.style.top=t.getPlayfieldY(80)+"px",t.prepareElement(t.fruitEl,-32,-16),t.playfieldEl.appendChild(t.fruitEl)},t.createPlayfieldElements=function(){t.doorEl=document.createElement("div"),t.doorEl.id="pcm-do",t.doorEl.style.display="none",t.playfieldEl.appendChild(t.doorEl),t.createDotElements(),t.createEnergizerElements(),t.createFruitElement()},t.createActors=function(){t.actors=[];for(var e=0;e<t.playerCount+4;e++)t.actors[e]=new m(e),e<t.playerCount?(t.actors[e].ghost=!1,t.actors[e].mode=1):t.actors[e].ghost=!0},t.restartActors=function(){for(var e in t.actors)t.actors[e].A()},t.createActorElements=function(){for(var e in t.actors)t.actors[e].createElement()},t.createPlayfield=function(){t.playfieldEl=document.createElement("div"),t.playfieldEl.id="pcm-p",t.canvasEl.appendChild(t.playfieldEl)},t.resetPlayfield=function(){t.dotsRemaining=0,t.dotsEaten=0,t.playfieldEl.innerHTML="",t.prepareElement(t.playfieldEl,256,0),t.determinePlayfieldDimensions(),t.preparePlayfield(),t.preparePaths(),t.prepareAllowedDirections(),t.createPlayfieldElements(),t.createActorElements()},t.keyPressed=function(e){var i=!1;switch(e){case 37:t.actors[0].requestedDir=4,i=!0;break;case 38:t.actors[0].requestedDir=1,i=!0;break;case 39:t.actors[0].requestedDir=8,i=!0;break;case 40:t.actors[0].requestedDir=2,i=!0;break;case 65:2==t.playerCount&&(t.actors[1].requestedDir=4,i=!0);break;case 83:2==t.playerCount&&(t.actors[1].requestedDir=2,i=!0);break;case 68:2==t.playerCount&&(t.actors[1].requestedDir=8,i=!0);break;case 87:2==t.playerCount&&(t.actors[1].requestedDir=1,i=!0)}return i},t.handleKeyDown=function(e){e||(e=window.event),t.keyPressed(e.keyCode)&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},t.canvasClicked=function(e,i){var o=t.getAbsoluteElPos(t.canvasEl);e-=o[1]- -32,i-=o[0]-0,o=t.actors[0];var a=t.getPlayfieldX(o.pos[1]+o.posDelta[1])+16,s=t.getPlayfieldY(o.pos[0]+o.posDelta[0])+32,r=Math.abs(e-a),n=Math.abs(i-s);r>8&&n<r?o.requestedDir=e>a?8:4:n>8&&r<n&&(o.requestedDir=i>s?2:1)},t.handleClick=function(e){e||(e=window.event),t.canvasClicked(e.clientX,e.clientY)},t.registerTouch=function(){document.body.addEventListener("touchstart",t.handleTouchStart,!0),t.canvasEl.addEventListener("touchstart",t.handleTouchStart,!0),document.f&&document.f.q&&document.f.q.addEventListener("touchstart",t.handleTouchStart,!0)},t.handleTouchStart=function(e){t.touchDX=0,t.touchDY=0,1==e.touches.length&&(t.touchStartX=e.touches[0].pageX,t.touchStartY=e.touches[0].pageY,document.body.addEventListener("touchmove",t.handleTouchMove,!0),document.body.addEventListener("touchend",t.handleTouchEnd,!0)),e.preventDefault(),e.stopPropagation()},t.handleTouchMove=function(e){e.touches.length>1?t.cancelTouch():(t.touchDX=e.touches[0].pageX-t.touchStartX,t.touchDY=e.touches[0].pageY-t.touchStartY),e.preventDefault(),e.stopPropagation()},t.handleTouchEnd=function(e){if(0==t.touchDX&&0==t.touchDY)t.canvasClicked(t.touchStartX,t.touchStartY);else{var i=Math.abs(t.touchDX),o=Math.abs(t.touchDY);i<8&&o<8?t.canvasClicked(t.touchStartX,t.touchStartY):i>15&&o<2*i/3?t.actors[0].requestedDir=t.touchDX>0?8:4:o>15&&i<2*o/3&&(t.actors[0].requestedDir=t.touchDY>0?2:1)}e.preventDefault(),e.stopPropagation(),t.cancelTouch()},t.cancelTouch=function(){document.body.removeEventListener("touchmove",t.handleTouchMove,!0),document.body.removeEventListener("touchend",t.handleTouchEnd,!0),t.touchStartX=null,t.touchStartY=null},t.addEventListeners=function(){window.addEventListener?(window.addEventListener("keydown",t.handleKeyDown,!1),t.canvasEl.addEventListener("click",t.handleClick,!1),t.registerTouch()):(document.body.attachEvent("onkeydown",t.handleKeyDown),t.canvasEl.attachEvent("onclick",t.handleClick))},t.startGameplay=function(){t.score=[0,0],t.extraLifeAwarded=[!1,!1],t.lives=3,t.level=0,t.paused=!1,t.globalTime=0,t.newLevel(!0)},t.restartGameplay=function(e){t.seed(0),t.frightModeTime=0,t.intervalTime=0,t.gameplayModeTime=0,t.fruitTime=0,t.ghostModeSwitchPos=0,t.ghostModeTime=t.levels.ghostModeSwitchTimes[0]*u,t.ghostExitingPenNow=!1,t.ghostEyesCount=0,t.tilesChanged=!1,t.updateCruiseElroySpeed(),t.hideFruit(),t.resetForcePenLeaveTime(),t.restartActors(),t.updateActorPositions(),t.switchMainGhostMode(2,!0);for(var i=t.playerCount+1;i<t.playerCount+4;i++)t.actors[i].a(16);t.dotEatingChannel=[0,0],t.dotEatingSoundPart=[1,1],t.clearDotEatingNow(),e?t.changeGameplayMode(4):t.changeGameplayMode(6)},t.initiateDoubleMode=function(){2!=t.playerCount&&(t.stopAllAudio(),t.changeGameplayMode(12))},t.newGame=function(){t.playerCount=1,t.createChrome(),t.createPlayfield(),t.createActors();// g.startGameplay()
},t.switchToDoubleMode=function(){t.playerCount=2,t.createChrome(),t.createPlayfield(),t.createActors(),t.startGameplay()},t.insertCoin=function(){8==t.gameplayMode||14==t.gameplayMode?t.newGame():t.initiateDoubleMode()},t.createKillScreenElement=function(i,o,a,s,r){var n=document.createElement("div");n.style.left=i+"px",n.style.top=o+"px",n.style.width=a+"px",n.style.height=s+"px",n.style.zIndex=119,r?(n.style.background="url("+e+") -"+t.killScreenTileX+"px -"+t.killScreenTileY+"px no-repeat",t.killScreenTileY+=8):n.style.background="black",t.playfieldEl.appendChild(n)},t.killScreen=function(){t.seed(0),t.canvasEl.style.visibility="",t.createKillScreenElement(272,0,200,80,!1),t.createKillScreenElement(280,80,192,56,!1),t.killScreenTileX=80,t.killScreenTileY=0;for(var e=280;e<=472;e+=8)for(var i=0;i<=136;i+=8).03>t.rand()&&(t.killScreenTileX=10*Math.floor(25*t.rand()),t.killScreenTileY=10*Math.floor(2*t.rand())),t.createKillScreenElement(e,i,8,8,!0);t.changeGameplayMode(14)},t.newLevel=function(e){for(var i in t.level++,t.levels=t.level>=c.length?c[c.length-1]:c[t.level],t.levels.frightTime>0&&t.levels.frightTime<=6&&(t.levels.frightTime=Math.round(t.levels.frightTime*u)),// end issue 14
t.levels.frightTotalTime=t.levels.frightTime+t.timing[1]*(2*t.levels.frightBlinkCount-1),t.actors)t.actors[i].dotCount=0;t.alternatePenLeavingScheme=!1,t.lostLifeOnThisLevel=!1,t.updateChrome(),t.resetPlayfield(),t.restartGameplay(e),256==t.level&&t.killScreen()},t.newLife=function(){t.lostLifeOnThisLevel=!0,t.alternatePenLeavingScheme=!0,t.alternateDotCount=0,t.lives--,t.updateChromeLives(),-1==t.lives?t.changeGameplayMode(8):t.restartGameplay(!1)},t.switchMainGhostMode=function(e,i){if(4==e&&0==t.levels.frightTime)for(var o in t.actors){var a=t.actors[o];a.ghost&&(a.reverseDirectionsNext=!0)}else{switch(a=t.mainGhostMode,4==e&&4!=t.mainGhostMode&&(t.lastMainGhostMode=t.mainGhostMode),t.mainGhostMode=e,(4==e||4==a)&&t.playAmbientSound(),e){case 1:case 2:t.currentPlayerSpeed=.8*t.levels.playerSpeed,t.currentDotEatingSpeed=.8*t.levels.dotEatingSpeed;break;case 4:t.currentPlayerSpeed=.8*t.levels.playerFrightSpeed,t.currentDotEatingSpeed=.8*t.levels.dotEatingFrightSpeed,t.frightModeTime=t.levels.frightTotalTime,t.modeScoreMultiplier=1}for(o in t.actors)(a=t.actors[o]).ghost?(64==e||i||(a.modeChangedWhileInPen=!0),4==e&&(a.eatenInThisFrightMode=!1),(8!=a.mode&&16!=a.mode&&32!=a.mode&&128!=a.mode&&64!=a.mode||i)&&(i||4==a.mode||a.mode==e||(a.reverseDirectionsNext=!0),a.a(e))):(a.fullSpeed=t.currentPlayerSpeed,a.dotEatingSpeed=t.currentDotEatingSpeed,a.tunnelSpeed=t.currentPlayerSpeed,a.d())}},t.figureOutPenLeaving=function(){if(t.alternatePenLeavingScheme)switch(t.alternateDotCount++,t.alternateDotCount){case 7:t.actors[t.playerCount+1].freeToLeavePen=!0;break;case 17:t.actors[t.playerCount+2].freeToLeavePen=!0;break;case 32:16==t.actors[t.playerCount+3].mode&&(t.alternatePenLeavingScheme=!1)}else 16==t.actors[t.playerCount+1].mode||8==t.actors[t.playerCount+1].mode?(t.actors[t.playerCount+1].dotCount++,t.actors[t.playerCount+1].dotCount>=t.levels.penLeavingLimits[1]&&(t.actors[t.playerCount+1].freeToLeavePen=!0)):16==t.actors[t.playerCount+2].mode||8==t.actors[t.playerCount+2].mode?(t.actors[t.playerCount+2].dotCount++,t.actors[t.playerCount+2].dotCount>=t.levels.penLeavingLimits[2]&&(t.actors[t.playerCount+2].freeToLeavePen=!0)):(16==t.actors[t.playerCount+3].mode||8==t.actors[t.playerCount+3].mode)&&(t.actors[t.playerCount+3].dotCount++,t.actors[t.playerCount+3].dotCount>=t.levels.penLeavingLimits[3]&&(t.actors[t.playerCount+3].freeToLeavePen=!0))},t.resetForcePenLeaveTime=function(){t.forcePenLeaveTime=t.levels.penForceTime*u},t.dotEaten=function(e,i){t.dotsRemaining--,t.dotsEaten++,t.actors[e].c(1),t.playDotEatingSound(e),2==t.playfield[i[0]][i[1]].dot?(t.switchMainGhostMode(4,!1),t.addToScore(50,e)):t.addToScore(10,e),document.getElementById(t.getDotElementId(i[0],i[1])).style.display="none",t.playfield[i[0]][i[1]].dot=0,t.updateCruiseElroySpeed(),t.resetForcePenLeaveTime(),t.figureOutPenLeaving(),(70==t.dotsEaten||170==t.dotsEaten)&&t.showFruit(),0==t.dotsRemaining&&t.finishLevel(),t.playAmbientSound()},t.getFruitSprite=function(e){return[e<=4?128:160,e=128+16*((e-1)%4)]},t.getFruitScoreSprite=function(e){return[128,e=16*(e-1)]},t.hideFruit=function(){t.fruitShown=!1,t.changeElementBkPos(t.fruitEl,32,16,!0)},t.showFruit=function(){t.fruitShown=!0;var e=t.getFruitSprite(t.levels.fruit);t.changeElementBkPos(t.fruitEl,e[0],e[1],!0),t.fruitTime=t.timing[15]+(t.timing[16]-t.timing[15])*t.rand()},t.eatFruit=function(e){if(t.fruitShown){t.playSound("fruit",0),t.fruitShown=!1;var i=t.getFruitScoreSprite(t.levels.fruit);t.changeElementBkPos(t.fruitEl,i[0],i[1],!0),t.fruitTime=t.timing[14],t.addToScore(t.levels.fruitScore,e)}},t.updateActorTargetPositions=function(){for(var e=t.playerCount;e<t.playerCount+4;e++)t.actors[e].B()},t.moveActors=function(){for(var e in t.actors)t.actors[e].move()},t.ghostDies=function(e,i){t.playSound("eating-ghost",0),t.addToScore(200*t.modeScoreMultiplier,i),t.modeScoreMultiplier*=2,t.ghostBeingEatenId=e,t.playerEatingGhostId=i,t.changeGameplayMode(1)},t.playerDies=function(e){t.playerDyingId=e,t.changeGameplayMode(2)},t.detectCollisions=function(){t.tilesChanged=!1;for(var e=t.playerCount;e<t.playerCount+4;e++)for(var i=0;i<t.playerCount;i++)if(t.actors[e].tilePos[0]==t.actors[i].tilePos[0]&&t.actors[e].tilePos[1]==t.actors[i].tilePos[1]){if(4==t.actors[e].mode){t.ghostDies(e,i);return}8!=t.actors[e].mode&&16!=t.actors[e].mode&&32!=t.actors[e].mode&&128!=t.actors[e].mode&&64!=t.actors[e].mode&&t.playerDies(i)}},t.updateCruiseElroySpeed=function(){var e=.8*t.levels.ghostSpeed;if(!t.lostLifeOnThisLevel||16!=t.actors[t.playerCount+3].mode){var i=t.levels;t.dotsRemaining<i.elroyDotsLeftPart2?e=.8*i.elroySpeedPart2:t.dotsRemaining<i.elroyDotsLeftPart1&&(e=.8*i.elroySpeedPart1)}e!=t.cruiseElroySpeed&&(t.cruiseElroySpeed=e,t.actors[t.playerCount].d())},t.getSpeedIntervals=function(e){if(!t.speedIntervals[e]){var i=0,o=0;t.speedIntervals[e]=[];for(var a=0;a<u;a++)Math.floor(i+=e)>o?(t.speedIntervals[e].push(!0),o=Math.floor(i)):t.speedIntervals[e].push(!1)}return t.speedIntervals[e]},t.finishLevel=function(){t.changeGameplayMode(9)},t.changeGameplayMode=function(e){if(t.gameplayMode=e,13!=e)for(var i=0;i<t.playerCount+4;i++)t.actors[i].b();switch(e){case 0:t.playAmbientSound();break;case 2:t.stopAllAudio(),t.gameplayModeTime=t.timing[3];break;case 3:0==t.playerDyingId?t.playSound("death",0):t.playSound("death-double",0),t.gameplayModeTime=t.timing[4];break;case 6:t.canvasEl.style.visibility="hidden",t.gameplayModeTime=t.timing[5];break;case 7:t.stopAllAudio(),t.canvasEl.style.visibility="",t.doorEl.style.display="block",(e=document.createElement("div")).id="pcm-re",t.prepareElement(e,160,0),t.playfieldEl.appendChild(e),t.gameplayModeTime=t.timing[6];break;case 4:t.doorEl.style.display="block",(e=document.createElement("div")).id="pcm-re",t.prepareElement(e,160,0),t.playfieldEl.appendChild(e),t.gameplayModeTime=t.timing[7],t.stopAllAudio(),2==t.playerCount?t.playSound("start-music-double",0,!0):t.playSound("start-music",0,!0);break;case 5:t.lives--,t.updateChromeLives(),t.gameplayModeTime=t.timing[8];break;case 8:case 14:e=document.getElementById("pcm-re"),google.dom.remove(e),t.stopAllAudio(),(e=document.createElement("div")).id="pcm-go",t.prepareElement(e,8,152),t.playfieldEl.appendChild(e),t.gameplayModeTime=t.timing[9];break;case 9:t.stopAllAudio(),t.gameplayModeTime=t.timing[10];break;case 10:t.doorEl.style.display="none",t.gameplayModeTime=t.timing[11];break;case 11:t.canvasEl.style.visibility="hidden",t.gameplayModeTime=t.timing[12];break;case 12:t.playfieldEl.style.visibility="hidden",t.gameplayModeTime=t.timing[13];break;case 1:t.gameplayModeTime=t.timing[2];break;case 13:t.startCutscene()}},t.showChrome=function(e){t.showElementById("pcm-sc-1-l",e),t.showElementById("pcm-sc-2-l",e),t.showElementById("pcm-sc-1",e),t.showElementById("pcm-sc-2",e),t.showElementById("pcm-li",e),t.showElementById("pcm-so",e)},t.toggleSound=function(e){return(e=window.event||e).cancelBubble=!0,google.pacManSound?(t.userDisabledSound=!0,t.stopAllAudio(),google.pacManSound=!1):(google.pacManSound=!0,t.playAmbientSound()),t.updateSoundIcon(),e.returnValue=!1},t.updateSoundIcon=function(){t.soundEl&&(google.pacManSound?t.changeElementBkPos(t.soundEl,216,105,!1):t.changeElementBkPos(t.soundEl,236,105,!1))},t.startCutscene=function(){for(var e in t.playfieldEl.style.visibility="hidden",t.canvasEl.style.visibility="",t.showChrome(!1),t.cutsceneCanvasEl=document.createElement("div"),t.cutsceneCanvasEl.id="pcm-cc",t.canvasEl.appendChild(t.cutsceneCanvasEl),t.cutscene=h[t.cutsceneId],t.cutsceneSequenceId=-1,t.frightModeTime=t.levels.frightTotalTime,t.cutsceneActors=[],t.cutscene.actors){var i=t.cutscene.actors[e].id;i>0&&(i+=t.playerCount-1);var o=document.createElement("div");o.className="pcm-ac",o.id="actor"+i,t.prepareElement(o,0,0),(i=new m(i)).el=o,i.elBackgroundPos=[0,0],i.elPos=[0,0],i.pos=[8*t.cutscene.actors[e].y,8*t.cutscene.actors[e].x],i.posDelta=[0,0],i.ghost=t.cutscene.actors[e].ghost,t.cutsceneCanvasEl.appendChild(o),t.cutsceneActors.push(i)}t.cutsceneNextSequence(),t.stopAllAudio(),t.playAmbientSound()},t.stopCutscene=function(){t.playfieldEl.style.visibility="",google.dom.remove(t.cutsceneCanvasEl),t.showChrome(!0),t.newLevel(!1)},t.cutsceneNextSequence=function(){if(t.cutsceneSequenceId++,t.cutscene.sequence.length==t.cutsceneSequenceId)t.stopCutscene();else{var e=t.cutscene.sequence[t.cutsceneSequenceId];for(var i in t.cutsceneTime=e.time*u,t.cutsceneActors){var o=t.cutsceneActors[i];o.dir=e.moves[i].dir,o.speed=e.moves[i].speed,e.moves[i].elId&&(o.el.id=e.moves[i].elId),e.moves[i].mode&&(o.mode=e.moves[i].mode),o.b()}}},t.checkCutscene=function(){t.cutsceneTime<=0&&t.cutsceneNextSequence()},t.advanceCutscene=function(){for(var e in t.cutsceneActors){var i=t.cutsceneActors[e],a=o[i.dir];i.pos[a.axis]+=a.increment*i.speed,i.b()}t.cutsceneTime--},t.updateActorPositions=function(){for(var e in t.actors)t.actors[e].k()},t.blinkEnergizers=function(){switch(t.gameplayMode){case 4:case 5:case 6:case 7:case 9:case 10:case 11:case 12:t.playfieldEl.className="";break;case 8:case 14:t.playfieldEl.className="blk";break;default:t.globalTime%(2*t.timing[0])==0?t.playfieldEl.className="":t.globalTime%(2*t.timing[0])==t.timing[0]&&(t.playfieldEl.className="blk")}},t.blinkScoreLabels=function(){if(13!=t.gameplayMode){var e="";if(t.globalTime%(2*t.timing[17])==0?e="visible":t.globalTime%(2*t.timing[17])==t.timing[17]&&(e="hidden"),e)for(var i=0;i<t.playerCount;i++)t.scoreLabelEl[i].style.visibility=e}},t.finishFrightMode=function(){t.switchMainGhostMode(t.lastMainGhostMode,!1)},t.handleGameplayModeTimer=function(){if(t.gameplayModeTime){switch(t.gameplayModeTime--,t.gameplayMode){case 2:case 3:for(var e=0;e<t.playerCount+4;e++)t.actors[e].b();break;case 10:Math.floor(t.gameplayModeTime/(t.timing[11]/8))%2==0?t.changeElementBkPos(t.playfieldEl,322,2,!1):t.changeElementBkPos(t.playfieldEl,322,138,!1)}if(t.gameplayModeTime<=0)switch(t.gameplayModeTime=0,t.gameplayMode){case 1:t.changeGameplayMode(0),t.ghostEyesCount++,t.playAmbientSound(),t.actors[t.ghostBeingEatenId].el.className="pcm-ac",t.actors[t.ghostBeingEatenId].a(8);var i=!1;for(e=t.playerCount;e<t.playerCount+4;e++)if(4==t.actors[e].mode||(16==t.actors[e].mode||128==t.actors[e].mode)&&!t.actors[e].eatenInThisFrightMode){i=!0;break}i||t.finishFrightMode();break;case 2:t.changeGameplayMode(3);break;case 3:t.newLife();break;case 4:t.changeGameplayMode(5);break;case 6:t.changeGameplayMode(7);break;case 7:case 5:e=document.getElementById("pcm-re"),google.dom.remove(e),t.changeGameplayMode(0);break;case 8:e=document.getElementById("pcm-go"),google.dom.remove(e),google.pacManQuery&&google.pacManQuery();break;case 9:t.changeGameplayMode(10);break;case 10:t.changeGameplayMode(11);break;case 11:t.levels.cutsceneId?(t.cutsceneId=t.levels.cutsceneId,t.changeGameplayMode(13)):(t.canvasEl.style.visibility="",t.newLevel(!1));break;case 12:t.playfieldEl.style.visibility="",t.canvasEl.style.visibility="",t.switchToDoubleMode()}}},t.handleFruitTimer=function(){t.fruitTime&&(t.fruitTime--,t.fruitTime<=0&&t.hideFruit())},t.handleGhostModeTimer=function(){if(t.frightModeTime)t.frightModeTime--,t.frightModeTime<=0&&(t.frightModeTime=0,t.finishFrightMode());else if(t.ghostModeTime>0&&(t.ghostModeTime--,t.ghostModeTime<=0&&(t.ghostModeTime=0,t.ghostModeSwitchPos++,t.levels.ghostModeSwitchTimes[t.ghostModeSwitchPos])))switch(t.ghostModeTime=t.levels.ghostModeSwitchTimes[t.ghostModeSwitchPos]*u,t.mainGhostMode){case 2:t.switchMainGhostMode(1,!1);break;case 1:t.switchMainGhostMode(2,!1)}},t.handleForcePenLeaveTimer=function(){if(t.forcePenLeaveTime&&(t.forcePenLeaveTime--,t.forcePenLeaveTime<=0)){for(var e=1;e<=3;e++)if(16==t.actors[t.playerCount+e].mode){t.actors[t.playerCount+e].freeToLeavePen=!0;break}t.resetForcePenLeaveTime()}},t.handleTimers=function(){0==t.gameplayMode&&(t.handleForcePenLeaveTimer(),t.handleFruitTimer(),t.handleGhostModeTimer()),t.handleGameplayModeTimer()},t.tick=function(){var e=(new Date).getTime();t.lastTimeDelta+=e-t.lastTime-t.tickInterval,t.lastTimeDelta>100&&(t.lastTimeDelta=100),t.canDecreaseFps&&t.lastTimeDelta>50&&(t.lastTimeSlownessCount++,20==t.lastTimeSlownessCount&&t.decreaseFps());var i=0;if(t.lastTimeDelta>t.tickInterval&&(i=Math.floor(t.lastTimeDelta/t.tickInterval),t.lastTimeDelta-=t.tickInterval*i),t.lastTime=e,13==t.gameplayMode){for(e=0;e<t.tickMultiplier+i;e++)t.advanceCutscene(),t.intervalTime=(t.intervalTime+1)%u,t.globalTime++;t.checkCutscene(),t.blinkScoreLabels()}else for(e=0;e<t.tickMultiplier+i;e++)t.moveActors(),0==t.gameplayMode&&t.tilesChanged&&(t.detectCollisions(),t.updateActorTargetPositions()),t.globalTime++,t.intervalTime=(t.intervalTime+1)%u,t.blinkEnergizers(),t.blinkScoreLabels(),t.handleTimers()},t.extraLife=function(e){t.playSound("extra-life",0),t.extraLifeAwarded[e]=!0,t.lives++,t.lives>5&&(t.lives=5),t.updateChromeLives()},t.addToScore=function(e,i){t.score[i]+=e,!t.extraLifeAwarded[i]&&t.score[i]>1e4&&t.extraLife(i),t.updateChromeScore(i)},t.updateChrome=function(){t.updateChromeLevel(),t.updateChromeLives();for(var e=0;e<t.playerCount;e++)t.updateChromeScore(e)},t.updateChromeScore=function(e){var i=t.score[e].toString();i.length>t.scoreDigits&&(i=i.substr(i.length-t.scoreDigits,t.scoreDigits));for(var o=0;o<t.scoreDigits;o++){var a=document.getElementById("pcm-sc-"+(e+1)+"-"+o),s=i.substr(o,1);s?t.changeElementBkPos(a,8+8*parseInt(s,10),144,!0):t.changeElementBkPos(a,48,0,!0)}},t.updateChromeLives=function(){t.livesEl.innerHTML="";for(var e=0;e<t.lives;e++){var i=document.createElement("div");i.className="pcm-lif",t.prepareElement(i,64,129),t.livesEl.appendChild(i)}},t.updateChromeLevel=function(){t.levelEl.innerHTML="";for(var e=t.level;e>=Math.max(t.level-4+1,1);e--){var i=e>=c.length?c[c.length-1].fruit:c[e].fruit,o=document.createElement("div");i=t.getFruitSprite(i),t.prepareElement(o,i[0],i[1]),t.levelEl.appendChild(o)}t.levelEl.style.marginTop=(4-Math.min(t.level,4))*16+"px"},t.createChrome=function(){t.canvasEl.innerHTML="",t.scoreDigits=1==t.playerCount?10:5,t.scoreLabelEl=[],t.scoreLabelEl[0]=document.createElement("div"),t.scoreLabelEl[0].id="pcm-sc-1-l",t.prepareElement(t.scoreLabelEl[0],160,56),t.canvasEl.appendChild(t.scoreLabelEl[0]),t.scoreEl=[],t.scoreEl[0]=document.createElement("div"),t.scoreEl[0].id="pcm-sc-1";for(var e=0;e<t.scoreDigits;e++){var i=document.createElement("div");i.id="pcm-sc-1-"+e,i.style.top=8*e+"px",i.style.left=0,i.style.position="absolute",i.style.width="8px",i.style.height="8px",t.prepareElement(i,48,0),t.scoreEl[0].appendChild(i)}if(t.canvasEl.appendChild(t.scoreEl[0]),t.livesEl=document.createElement("div"),t.livesEl.id="pcm-li",t.canvasEl.appendChild(t.livesEl),t.levelEl=document.createElement("div"),t.levelEl.id="pcm-le",t.canvasEl.appendChild(t.levelEl),2==t.playerCount){for(t.scoreLabelEl[1]=document.createElement("div"),t.scoreLabelEl[1].id="pcm-sc-2-l",t.prepareElement(t.scoreLabelEl[1],160,64),t.canvasEl.appendChild(t.scoreLabelEl[1]),t.scoreEl[1]=document.createElement("div"),t.scoreEl[1].id="pcm-sc-2",e=0;e<t.scoreDigits;e++)(i=document.createElement("div")).id="pcm-sc-2-"+e,i.style.top=8*e+"px",i.style.left=0,i.style.position="absolute",i.style.width="8px",i.style.height="8px",t.prepareElement(i,48,0),t.scoreEl[1].appendChild(i);t.canvasEl.appendChild(t.scoreEl[1])}t.soundAvailable&&(t.soundEl=document.createElement("div"),t.soundEl.id="pcm-so",t.prepareElement(t.soundEl,-32,-16),t.canvasEl.appendChild(t.soundEl),t.soundEl.onclick=t.toggleSound,t.updateSoundIcon())},t.clearDotEatingNow=function(){t.dotEatingNow=[!1,!1],t.dotEatingNext=[!1,!1]},t.playSound=function(e,i,o){if(!(!t.soundAvailable||!google.pacManSound||t.paused)){o||t.stopSoundChannel(i);try{t.flashSoundPlayer.playTrack(e,i)}catch(e){t.soundAvailable=!1}}},t.stopSoundChannel=function(e){if(t.soundAvailable)try{t.flashSoundPlayer.stopChannel(e)}catch(e){t.soundAvailable=!1}},t.stopAllAudio=function(){if(t.soundAvailable){try{t.flashSoundPlayer.stopAmbientTrack()}catch(e){t.soundAvailable=!1}for(var e=0;e<5;e++)t.stopSoundChannel(e)}},t.playDotEatingSound=function(e){if(t.soundAvailable&&google.pacManSound&&0==t.gameplayMode){if(t.dotEatingNow[e])t.dotEatingNext[e]=!0;else{if(0==e){var i=1==t.dotEatingSoundPart[e]?"eating-dot-1":"eating-dot-2";t.playSound(i,1+t.dotEatingChannel[e],!0),t.dotTimer=window.setInterval(t.repeatDotEatingSoundPacMan,150)}else t.playSound("eating-dot-double",3+t.dotEatingChannel[e],!0),t.dotTimerMs=window.setInterval(t.repeatDotEatingSoundMsPacMan,150);t.dotEatingChannel[e]=(t.dotEatingChannel[e]+1)%2,t.dotEatingSoundPart[e]=3-t.dotEatingSoundPart[e]}}},t.repeatDotEatingSound=function(e){t.dotEatingNow[e]=!1,t.dotEatingNext[e]&&(t.dotEatingNext[e]=!1,t.playDotEatingSound(e))},t.repeatDotEatingSoundPacMan=function(){t.repeatDotEatingSound(0)},t.repeatDotEatingSoundMsPacMan=function(){t.repeatDotEatingSound(1)},t.playAmbientSound=function(){if(t.soundAvailable&&google.pacManSound){var e=0;if(0==t.gameplayMode||1==t.gameplayMode?e=t.ghostEyesCount?"ambient-eyes":4==t.mainGhostMode?"ambient-fright":t.dotsEaten>241?"ambient-4":t.dotsEaten>207?"ambient-3":t.dotsEaten>138?"ambient-2":"ambient-1":13==t.gameplayMode&&(e="cutscene"),e)try{t.flashSoundPlayer.playAmbientTrack(e)}catch(e){t.soundAvailable=!1}}},t.initializeTickTimer=function(){for(var e in window.clearInterval(t.tickTimer),t.fpsChoice=2,t.fps=g[t.fpsChoice],t.tickInterval=1e3/t.fps,t.tickMultiplier=u/t.fps,t.timing={},d){var i=google.pacManSound||7!=e&&8!=e?d[e]:1;t.timing[e]=Math.round(i*u)}t.lastTime=(new Date).getTime(),t.lastTimeDelta=0,t.lastTimeSlownessCount=0,t.tickTimer=window.setInterval(t.tick,t.tickInterval)},t.decreaseFps=function(){t.fpsChoice<g.length-1&&(t.fpsChoice++,t.initializeTickTimer(),t.fpsChoice==g.length-1&&(t.canDecreaseFps=!1))},t.addCss=function(){var e="#pcm-c {  width: 554px;  border-top: 25px solid black;  padding-bottom: 25px;  height: 136px;  position: relative; outline: 0;  overflow: hidden;  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);}#pcm-c * {  position: absolute;  overflow: hidden;}#pcm-p,#pcm-cc {  left: 45px;  width: 464px;  height: 136px;  z-index: 99;  overflow: hidden;}#pcm-p .pcm-d {  width: 2px;  height: 2px;  margin-left: 3px;  margin-top: 3px;  background: #f8b090;  z-index: 100;}#pcm-p .pcm-e {  width: 8px;  height: 8px;  z-index: 101;}#pcm-sc-1 {  left: 18px;  top: 16px;  width: 8px;  height: 56px;  position: absolute;  overflow: hidden;}#pcm-sc-2 {  left: 18px;  top: 80px;  width: 8px;  height: 56px;  position: absolute;  overflow: hidden;}#pcm-le {  position: absolute;  left: 515px;  top: 74px;  height: 64px;  width: 32px;} #pcm-le div {  position: relative;}#pcm-sc-1-l {    left: -2px;  top: 0;  width: 48px;  height: 8px;}#pcm-sc-2-l {    left: -2px;  top: 64px;  width: 48px;  height: 8px;}#pcm-so {  left: 7px;  top: 116px;  width: 12px;  height: 12px;  border: 8px solid black;  cursor: pointer;}#pcm-li {  position: absolute;  left: 523px;  top: 0;  height: 80px;  width: 16px;}#pcm-li .pcm-lif {  position: relative;  width: 16px;  height: 12px;  margin-bottom: 3px;}#pcm-p.blk .pcm-e {  visibility: hidden;}#pcm-c .pcm-ac {  width: 16px;  height: 16px;  margin-left: -4px;  margin-top: -4px;  z-index: 110;}#pcm-c .pcm-n {  z-index: 111;}#pcm-c #pcm-stck {  z-index: 109;}#pcm-c #pcm-gbug {  width: 32px;}#pcm-c #pcm-bpcm {  width: 32px;  height: 32px;  margin-left: -20px;  margin-top: -20px;}#pcm-f,#pcm-le div {  width: 32px;  height: 16px;  z-index: 105;}#pcm-f {  margin-left: -8px;  margin-top: -4px;}#pcm-do {  width: 19px;  height: 2px;  left: 279px;  top: 46px;  overflow: hidden;  position: absolute;  background: #ffaaa5;}#pcm-re {  width: 48px;  height: 8px;  z-index: 120;  left: 264px;  top: 80px;}#pcm-go {  width: 80px;  height: 8px;  z-index: 120;  left: 248px;  top: 80px;}";t.styleElement=document.createElement("style"),t.styleElement.type="text/css",t.styleElement.styleSheet?t.styleElement.styleSheet.cssText=e:t.styleElement.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(t.styleElement)},t.createCanvasElement=function(){t.canvasEl=document.createElement("div"),t.canvasEl.id="pcm-c",t.canvasEl.hideFocus=!0,document.getElementById("logo").appendChild(t.canvasEl),t.canvasEl.tabIndex=0,t.canvasEl.focus()},t.everythingIsReady=function(){if(!t.ready){t.ready=!0;var e=document.getElementById("logo-l");google.dom.remove(e),//document.getElementById("logo").style.background = "black";
t.addCss(),t.createCanvasElement(),t.speedIntervals=[],t.oppositeDirections=[],t.oppositeDirections[1]=2,t.oppositeDirections[2]=1,t.oppositeDirections[4]=8,t.oppositeDirections[8]=4,t.addEventListeners(),t.fpsChoice=0,t.canDecreaseFps=!0,t.initializeTickTimer(),t.newGame()}},t.checkIfEverythingIsReady=function(){(t.soundReady||t.graphicsReady)&&t.updateLoadingProgress(.67),t.soundReady&&t.graphicsReady&&(t.updateLoadingProgress(1),t.everythingIsReady())},t.preloadImage=function(e){var i=new Image,o=google.browser.engine.IE;o||(i.onload=t.imageLoaded),i.src=e,o&&t.imageLoaded()},t.imageLoaded=function(){t.graphicsReady=!0,t.checkIfEverythingIsReady()},t.prepareGraphics=function(){t.graphicsReady=!1,t.preloadImage(e)},t.trimString=function(e){return e.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},t.g=function(e,t){return e<t?-1:e>t?1:0},t.compareVersions=function(e,i){for(var o=0,a=t.trimString(String(e)).split("."),s=t.trimString(String(i)).split("."),r=Math.max(a.length,s.length),n=0;0==o&&n<r;n++){var l=a[n]||"",d=s[n]||"",c=RegExp("(\\d*)(\\D*)","g"),p=RegExp("(\\d*)(\\D*)","g");do{var h=c.exec(l)||["","",""],g=p.exec(d)||["","",""];if(0==h[0].length&&0==g[0].length)break;o=0==h[1].length?0:parseInt(h[1],10);var u=0==g[1].length?0:parseInt(g[1],10);o=t.g(o,u)||t.g(0==h[2].length,0==g[2].length)||t.g(h[2],g[2])}while(0==o)}return o},t.getFlashVersion=function(e){return(e=e.match(/[\d]+/g)).length=3,e.join(".")},t.detectFlash=function(){var e=!1,i="";if(navigator.plugins&&navigator.plugins.length){var o=navigator.plugins["Shockwave Flash"];o&&(e=!0,o.description&&(i=t.getFlashVersion(o.description))),navigator.plugins["Shockwave Flash 2.0"]&&(e=!0,i="2.0.0.11")}else if(navigator.mimeTypes&&navigator.mimeTypes.length)(e=(o=navigator.mimeTypes["application/x-shockwave-flash"])&&o.enabledPlugin)&&(i=o.enabledPlugin.description,i=t.getFlashVersion(i));else try{o=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),e=!0,i=t.getFlashVersion(o.GetVariable("$version"))}catch(a){try{o=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),e=!0,i="6.0.21"}catch(a){try{o=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),e=!0,i=t.getFlashVersion(o.GetVariable("$version"))}catch(e){}}}t.hasFlash=e,t.flashVersion=i},t.isFlashVersion=function(e){return t.compareVersions(t.flashVersion,e)>=0},t.prepareSound=function(){t.soundAvailable=!1,t.soundReady=!1,t.detectFlash(),t.hasFlash&&t.isFlashVersion("9.0.0.0")?(t.flashIframe=document.createElement("iframe"),t.flashIframe.name="pm-sound",t.flashIframe.style.position="absolute",t.flashIframe.style.top="-150px",t.flashIframe.style.border=0,t.flashIframe.style.width="100px",t.flashIframe.style.height="100px",google.dom.append(t.flashIframe),t.flashIframeDoc=t.flashIframe.contentDocument,(void 0==t.flashIframeDoc||null==t.flashIframeDoc)&&(t.flashIframeDoc=t.flashIframe.contentWindow.document),t.flashIframeDoc.open(),t.flashIframeDoc.write('<html><head></head><body><object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="0" height="0" id="pacman-sound-player" type="application/x-shockwave-flash"> <param name="movie" value="src/swf/pacman10-hp-sound.swf"> <param name="allowScriptAccess" value="always"> <object id="pacman-sound-player-2"  type="application/x-shockwave-flash" data="src/swf/pacman10-hp-sound.swf" width="0" height="0"><param name="allowScriptAccess" value="always"> </object></object></body></html>'),t.flashIframeDoc.close(),window.setTimeout(t.flashNotReady,3e3)):(t.soundReady=!0,t.checkIfEverythingIsReady())},t.flashNotReady=function(){t.ready||(t.soundAvailable=!1,t.soundReady=!0,t.checkIfEverythingIsReady())},t.flashReady=function(e){t.flashSoundPlayer=e,t.soundAvailable=!0,t.soundReady=!0,t.checkIfEverythingIsReady()},t.flashLoaded=function(){if(t.flashIframeDoc){var e=t.flashIframeDoc.getElementById("pacman-sound-player");if(e&&e.playTrack||(e=t.flashIframeDoc.getElementById("pacman-sound-player-2"))&&e.playTrack){t.flashReady(e);return}}t.flashNotReady()},t.destroy=function(){google.pacman&&(t.stopAllAudio(),window.clearInterval(t.tickTimer),window.clearInterval(t.dotTimer),window.clearInterval(t.dotTimerMs),google.dom.remove(t.styleElement),google.dom.remove(t.flashIframe),google.dom.remove(t.canvasEl),google.pacman=void 0)},t.exportFunctionCalls=function(){google.pacman={},google.pacman.insertCoin=t.insertCoin,google.pacman.startGameplay=t.startGameplay,google.pacman.flashLoaded=t.flashLoaded,google.pacman.destroy=t.destroy,google.pacman.keyPressed=t.keyPressed},t.updateLoadingProgress=function(e){e=Math.round(200*e),document.getElementById("logo-b").style.width=e+"px"},t.init=function(){t.ready=!1,document.getElementById("logo").title="",t.updateLoadingProgress(.33),t.exportFunctionCalls(),t.useCss=-1==navigator.userAgent.indexOf("MSIE 5.")&&-1==navigator.userAgent.indexOf("MSIE 6.")&&-1==navigator.userAgent.indexOf("MSIE 7."),t.prepareGraphics(),t.prepareSound()},t.init()}();